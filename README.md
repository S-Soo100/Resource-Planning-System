# KARS (Korea Auto Repair Shop) - 자동차 정비소 재고 관리 시스템

**버전: v1.3.0**

## 프로젝트 개요

KARS는 자동차 정비소를 위한 통합 재고 관리 시스템입니다. 이 시스템은 재고 관리, 발주 관리, 패키지 관리 등 정비소 운영에 필요한 핵심 기능을 제공합니다.

## 주요 기능

### 1. 재고 관리

- **실시간 재고 조회**: 현재 보유한 모든 부품의 재고 현황을 실시간으로 확인
- **재고 알림**: 재고가 부족한 품목에 대한 자동 알림 기능
- **재고 이력 관리**: 모든 재고 변동에 대한 상세 이력 추적
- **카테고리별 관리**: 부품을 카테고리별로 구분하여 효율적인 관리 (기본 열림 상태)
- **입고/출고 통합 관리**: 입출고 기록 조회와 작업이 한 페이지에서 가능
- **즉시 반영**: 입고/출고 처리 후 바로 기록 목록에서 확인 가능
- **바코드/QR코드 지원**: 스캔을 통한 빠른 재고 확인 및 관리

### 2. 발주 관리

- **발주 요청**: 사용자가 필요한 품목 발주 신청
- **발주 승인**: 관리자의 발주 요청 검토 및 승인
- **발주 기록 확인**: 과거 발주 내역 조회 및 상태 추적
- **발주 상세 정보 확장 표시 기능**
- **발주 요청 후 부드러운 페이지 전환**
- **출고 완료 후 재고 자동 반영**

### 3. 패키지 관리

- **패키지 구성**: 자주 사용되는 부품들을 패키지로 구성
- **패키지 발주**: 구성된 패키지 단위로 발주 요청
- **패키지 수정**: 기존 패키지의 구성품 수정 및 관리
- **패키지 이력**: 패키지 사용 내역 추적

### 4. 사용자 관리

- **역할 기반 접근 제어**: 관리자, 직원, 타업체 등 역할별 권한 관리
- **창고 접근 권한 관리**: 사용자별 창고 접근 제한 설정 (`restrictedWhs`)
- **계정 관리**: 사용자 계정 생성, 수정, 삭제
- **권한별 UI 제어**: 권한에 따른 메뉴 및 기능 접근 제한
- **로그인/로그아웃**: 안전한 인증 시스템

### 5. 보고서 및 분석

- **재고 보고서**: 재고 현황 및 변동 추이 분석
- **발주 보고서**: 발주 내역 및 패턴 분석
- **사용량 분석**: 부품별 사용 빈도 및 패턴 분석

## 기술 스택

- **프론트엔드**: React, TypeScript, Tailwind CSS
- **백엔드**: Node.js, Express
- **데이터베이스**: MongoDB
- **인증**: JWT (JSON Web Tokens)
- **상태 관리**: Zustand
- **UI 컴포넌트**: Headless UI, Heroicons
- **폼 관리**: React Hook Form
- **API 통신**: Axios
- **날짜 처리**: date-fns
- **파일 업로드**: AWS S3

## 시스템 요구사항

- Node.js 18.0.0 이상
- MongoDB 4.0 이상
- 최신 버전의 웹 브라우저 (Chrome, Firefox, Safari, Edge)

## 설치 및 실행 방법

1. 저장소 클론

```bash
git clone https://github.com/yourusername/kars.git
cd kars
```

2. 의존성 설치

```bash
npm install
```

3. 환경 변수 설정

```bash
cp .env.example .env
# .env 파일을 열어 필요한 환경 변수 설정
```

4. 개발 서버 실행

```bash
npm run dev
```

## 창고 접근 권한 관리 가이드 (v1.2.0)

### 관리자용 - 사용자 창고 권한 설정

1. **사용자 생성 시 권한 설정**

   - 관리자 페이지 → 팀 멤버 → "새 사용자 생성" 클릭
   - 기본 정보 입력 후 "창고 접근 제한" 섹션에서 제한할 창고 선택
   - 체크된 창고는 해당 사용자가 접근할 수 없습니다

2. **권한 확인**
   - 생성된 사용자는 제한된 창고에 대해 다음과 같은 제한이 적용됩니다:
     - 재고 조회 시 제한된 창고의 데이터 숨김
     - 발주 요청 시 제한된 창고 선택 불가
     - 발주 기록에서 제한된 창고의 발주 기록 숨김

### 사용자용 - 권한 제한 이해

- **접근 가능한 창고**: 정상적으로 모든 기능 사용 가능
- **접근 제한된 창고**:
  - 창고 목록에서 "접근 불가" 표시되거나 숨김
  - 발주 요청 시 선택 시도하면 경고 메시지 표시
  - 관련 데이터가 화면에 표시되지 않음

### 권한 레벨별 특징

| 권한 레벨 | 창고 제한 적용 | 관리 기능 | 발주 승인 | 특이사항            |
| --------- | -------------- | --------- | --------- | ------------------- |
| Admin     | ❌             | 전체      | ✅        | 모든 창고 접근 가능 |
| Moderator | ✅             | 읽기 전용 | ✅        | 재고 수정 불가      |
| User      | ✅             | ❌        | ❌        | 기본 사용자         |
| Supplier  | ✅             | ❌        | ❌        | 발주 메뉴만 접근    |

```

## 사용자 역할 및 권한

### 1. 관리자 (Admin)

- 모든 기능에 대한 완전한 접근 권한
- 모든 창고에 대한 접근 권한 (restrictedWhs 제한 없음)
- 사용자 계정 관리 및 창고 접근 권한 설정
- 시스템 설정 관리
- 재고 및 발주 관리
- 보고서 생성 및 분석

### 2. 1차승인권자 (Moderator)

- 읽기 전용 모드로 관리 기능 접근
- 발주 승인 권한
- 창고 접근 권한 제한 적용 (`restrictedWhs`)
- 재고 조회 (수정 불가)
- 발주 기록 확인

### 3. 일반 사용자 (User)

- 재고 조회
- 발주 요청
- 발주 기록 확인
- 창고 접근 권한 제한 적용 (`restrictedWhs`)
- 제한된 보고서 접근

### 4. 외부업체 (Supplier)

- 발주 관련 기능만 제한적 접근
- 발주 메뉴만 표시
- 창고 접근 권한 제한 적용 (`restrictedWhs`)
- 발주 상태 변경 불가

## 최근 업데이트

### v1.3.0 (2025년 6월) - 입출고 관리 시스템 개선

#### 🔄 입출고 기능 재구성

- **입출고 기능 통합**: /stock 페이지의 입고/출고 기능을 /ioHistory 페이지로 이동하여 논리적 구조 개선
- **실시간 반영**: 입고/출고 처리 후 즉시 기록 목록에서 확인 가능한 통합 UI 구현
- **사용자 경험 향상**: 입출고 작업과 이력 확인이 한 페이지에서 가능

#### 🛠️ 사용자 인터페이스 개선

- **카테고리 토글 개선**: /stock 페이지의 모든 카테고리가 기본적으로 열린 상태로 변경
- **즉시 확인 가능**: 페이지 로드 시 모든 품목을 바로 확인할 수 있어 사용성 향상

#### 🔧 용어 및 메시지 정확성 개선

- **출고 관련 워딩 수정**: 모든 출고 관련 메시지에서 "발주" → "출고"로 정확한 용어 사용
- **사용자 혼란 방지**: 일관된 용어 사용으로 기능 이해도 향상

#### 🎯 코드 품질 개선

- **타입 시스템 개선**: AttachedFile 타입을 공통 타입으로 분리하여 재사용성 향상
- **빌드 안정성**: TypeScript 컴파일 오류 해결 및 타입 일관성 확보
- **코드 구조 개선**: 관심사 분리를 통한 유지보수성 향상

### v1.2.0 (2025년 5월) - 창고 접근 권한 관리 시스템

#### 🔒 창고 접근 권한 관리 (`restrictedWhs`) 기능 구현

- **사용자별 창고 접근 제한**: 관리자가 사용자별로 접근 불가능한 창고를 설정할 수 있는 기능 추가
- **권한 기반 창고 필터링**: 사용자 권한에 따라 접근 가능한 창고만 표시
- **발주 시스템 권한 통합**: 발주 요청 시 접근 불가능한 창고는 선택 불가 처리
- **발주 기록 권한 필터링**: 접근 불가능한 창고의 발주 기록은 조회 제한

#### 🛠️ 관리자 UI 개선

- **사용자 생성 모달 개선**: 창고 접근 제한 설정을 위한 체크박스 UI 추가
- **직관적인 권한 설정**: 체크된 창고는 해당 사용자가 접근할 수 없도록 시각적 표시
- **실시간 제한 현황**: 선택된 제한 창고 개수 표시 및 안내 메시지

#### 🔧 시스템 아키텍처 개선

- **유틸리티 함수 도입**: `warehousePermissions.ts`를 통한 권한 체크 로직 중앙화
- **타입 안전성 강화**: TypeScript 타입 정의 개선 및 일관성 유지
- **훅 기반 권한 관리**: `useWarehouseItems` 훅에서 자동 권한 필터링 적용

#### 🎯 사용자 경험 개선

- **접근 거부 알림**: 권한 없는 창고 선택 시 명확한 에러 메시지 표시
- **시각적 구분**: 접근 불가능한 창고는 비활성화 상태로 표시
- **권한별 UI 조정**: 사용자 권한에 따른 적절한 UI 요소 표시/숨김

### v1.1.0 - 발주 시스템 개선

- 발주 요청 후 부드러운 페이지 전환 구현
- 출고 완료 후 재고 자동 반영 로직 수정
- 발주 요청 UX 개선: 발주 요청 완료 후 로딩 표시 및 자동 페이지 이동 기능 추가
- 발주 기록 페이지 개선: 발주 상세 정보 확장 표시 기능 추가

### v1.0.0 - 초기 버전

#### 재고 관리 개선

- 실시간 재고 업데이트 기능 강화
- 재고 알림 시스템 개선
- 카테고리별 재고 관리 기능 강화

#### 사용자 인터페이스 개선

- 반응형 디자인 강화
- 모바일 환경 최적화
- 사용자 경험 개선

## 기여 방법

1. 이슈 생성 또는 기존 이슈 확인
2. 새로운 브랜치 생성
3. 변경사항 커밋
4. Pull Request 생성

## 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

## 연락처

프로젝트 관련 문의사항은 이슈를 통해 남겨주시기 바랍니다.
```
