# KARS ì‹œì—° ì‹œìŠ¤í…œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

> **[2025-07-23 v1.7.0] ì£¼ìš” ì—…ë°ì´íŠ¸**
>
> - **ì‹œì—° ê¸°ë¡ í˜ì´ì§€ UI/UX ëŒ€í­ ê°œì„ **: ì •ë ¬, ì¹´ë“œ ë ˆì´ì•„ì›ƒ, ì •ë³´ í‘œì‹œ ë“± ì „ë©´ ê°œì„ 
>   - ì‹œì—° ì‹œì‘ì¼ ê¸°ì¤€ ì •ë ¬ ê¸°ëŠ¥ (ìµœì‹ ìˆœ/ì˜¤ë˜ëœìˆœ í† ê¸€)
>   - ì¹´ë“œ ë ˆì´ì•„ì›ƒ ìµœì í™” (2ì¤„ â†’ 1ì¤„ í†µí•©, ì¸ë±ìŠ¤ ë²ˆí˜¸ í‘œì‹œ)
>   - ì¹´ë“œ í† ê¸€ ê¸°ëŠ¥ìœ¼ë¡œ ì‹œì—° ê¸°ê°„, ì¥ì†Œ, í’ˆëª© ë“± ìƒì„¸ ì •ë³´ í™•ì¥ í‘œì‹œ
>   - ëª…í™•í•œ ìƒì„¸ë³´ê¸° ë²„íŠ¼ìœ¼ë¡œ í˜ì´ì§€ ì´ë™ ê¸°ëŠ¥ ê°œì„ 
>   - ìœ ë£Œ ì‹œì—° ê°€ê²© í‘œì‹œ, ë°°ì†¡ ë°©ë²• ì •ë³´ í‘œì‹œ
>   - ëª¨ë°”ì¼ UI ìµœì í™” (ë°ìŠ¤í¬í†±ê³¼ ë™ì¼í•œ ê¸°ëŠ¥ ì œê³µ)

> **[2025-07-05 v1.5.1] ì´ì „ ì—…ë°ì´íŠ¸**
>
> - ì‹œì—° ì‹ ì²­ í¼ UI/UX ê°œì„  (ì°½ê³  ì„ íƒ ë“œë¡­ë‹¤ìš´ ë‹¨ì¼í™”, ìë™ ì„ íƒ ë¡œì§ ê°œì„ )
> - ì‹œì—° ì•„ì´í…œ ì„ íƒ: ì°½ê³ ë³„ ì‹¤ì œ ì¬ê³  ì•„ì´í…œ ëª©ë¡ ê¸°ë°˜ ë™ì  ì„ íƒ UI ì œê³µ
> - ì²´í¬ë°•ìŠ¤ ë° ìˆ˜ëŸ‰ ì¡°ì ˆ ë¡œì§ ê°œì„  (teamItem ê¸°ì¤€ ì¼ì›í™”, ì „ì²´ ì„ íƒ/í•´ì œ ë™ì‘ ê°œì„ )
> - ë¶ˆí•„ìš”í•œ ì •ë³´(ì°½ê³  ì£¼ì†Œ ë“±) ì œê±°, ë“œë¡­ë‹¤ìš´ë§Œ ë…¸ì¶œ
> - ì‹¤ì œ ì¬ê³  ì—°ë™: ì°½ê³  ë³€ê²½ ì‹œ í•´ë‹¹ ì°½ê³ ì˜ ì‹¤ì¬ê³  ì•„ì´í…œë§Œ ì„ íƒ ê°€ëŠ¥
> - ë¬¸ì„œí™”: CHANGELOG, ì—…ë°ì´íŠ¸ ë‚´ì—­, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìµœì‹ í™”

---

## 1. ê°œìš”

KARS ì‹œì—° ì‹œìŠ¤í…œì€ ì œí’ˆ ì‹œì—°ì„ ìœ„í•œ ì „ìš© ê´€ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ì¼ë°˜ ì£¼ë¬¸ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ì‹œì—° ëª©ì ì— ìµœì í™”ëœ ë³„ë„ì˜ ì›Œí¬í”Œë¡œìš°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

### 1.1 ì£¼ìš” íŠ¹ì§•

- **ì‹œì—° ì „ìš© í”„ë¡œì„¸ìŠ¤**: ì¼ë°˜ ì£¼ë¬¸ê³¼ êµ¬ë¶„ëœ ì‹œì—° ì „ìš© ìƒíƒœ ê´€ë¦¬
- **ì¬ê³  ì—°ë™**: ì‹œì—° ì¶œê³  ì‹œ ìë™ ì¬ê³  ì°¨ê° ë° ë³µê·€ ì‹œ ì¬ê³  ë³µêµ¬
- **ê¶Œí•œ ê¸°ë°˜ ì ‘ê·¼**: ì‚¬ìš©ì ê¶Œí•œì— ë”°ë¥¸ ì°¨ë³„í™”ëœ ê¸°ëŠ¥ ì œê³µ
- **íŒ€ ë‹¨ìœ„ ê´€ë¦¬**: íŒ€ë³„ ì‹œì—° ë°ì´í„° ê²©ë¦¬ ë° ê´€ë¦¬

## 2. ì‹œì—° ìƒíƒœ ê´€ë¦¬

### 2.1 ì‹œì—° ìƒíƒœ íë¦„

```mermaid
graph TD
    A[requested<br/>ìš”ì²­] --> B[approved<br/>ìŠ¹ì¸]
    A --> C[rejected<br/>ë°˜ë ¤]
    B --> D[confirmedByShipper<br/>ì¶œê³ ì í™•ì¸]
    B --> E[rejected<br/>ë°˜ë ¤]
    B --> F[shipmentCompleted<br/>ì¶œê³  ì™„ë£Œ]
    D --> G[shipmentCompleted<br/>ì¶œê³  ì™„ë£Œ]
    D --> H[rejectedByShipper<br/>ì¶œê³ ì ë°˜ë ¤]
    F --> I[demoCompleted<br/>ì‹œì—° ì¢…ë£Œ]
    G --> I[demoCompleted<br/>ì‹œì—° ì¢…ë£Œ]
```

### 2.2 ìƒíƒœë³„ ì„¤ëª…

| ìƒíƒœ                 | ì˜ë¯¸             | ë‹¤ìŒ ê°€ëŠ¥ ìƒíƒœ                                        | ê¶Œí•œ             |
| -------------------- | ---------------- | ----------------------------------------------------- | ---------------- |
| `requested`          | ìš”ì²­ (ì´ˆê¸° ìƒíƒœ) | `approved`, `rejected`                                | Moderator, Admin |
| `approved`           | ìŠ¹ì¸             | `confirmedByShipper`, `shipmentCompleted`, `rejected` | Admin            |
| `rejected`           | ë°˜ë ¤             | -                                                     | ìµœì¢… ìƒíƒœ        |
| `confirmedByShipper` | ì¶œê³ ì í™•ì¸      | `shipmentCompleted`, `rejectedByShipper`              | Admin            |
| `shipmentCompleted`  | ì¶œê³  ì™„ë£Œ        | `demoCompleted`                                       | Admin            |
| `rejectedByShipper`  | ì¶œê³ ì ë°˜ë ¤      | -                                                     | ìµœì¢… ìƒíƒœ        |
| `demoCompleted`      | ì‹œì—° ì¢…ë£Œ        | -                                                     | ìµœì¢… ìƒíƒœ        |

### 2.3 ìƒíƒœ ë³€ê²½ ê·œì¹™

#### ê¶Œí•œë³„ ìƒíƒœ ë³€ê²½ ê°€ëŠ¥ ë²”ìœ„

**Admin:**
- **ëª¨ë“  ìƒíƒœ** ë³€ê²½ ê°€ëŠ¥ (requested, approved, rejected, confirmedByShipper, shipmentCompleted, rejectedByShipper, demoCompleted)
- ëª¨ë“  ì‹œì—° ê±´ì˜ ìƒíƒœë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŒ
- ì‹œì—° ì™„ë£Œ(demoCompleted) ìƒíƒœë„ ë³€ê²½ ê°€ëŠ¥

**Moderator:**
- **ì´ˆê¸° ìŠ¹ì¸ ë‹¨ê³„**ë§Œ ë³€ê²½ ê°€ëŠ¥ (requested, approved, rejected)
- ë³¸ì¸ì´ ì‘ì„±í•œ ì‹œì—°ì€ ìŠ¹ì¸/ë°˜ë ¤ ë¶ˆê°€ (ì´í•´ ì¶©ëŒ ë°©ì§€)
- ì¶œê³  ë‹¨ê³„ ìƒíƒœëŠ” ë³€ê²½ ë¶ˆê°€

**User/Supplier:**
- ìƒíƒœ ë³€ê²½ ê¶Œí•œ ì—†ìŒ (ì¡°íšŒë§Œ ê°€ëŠ¥)

#### ìƒíƒœ ë³€ê²½ ë§¤íŠ¸ë¦­ìŠ¤

| ê¶Œí•œ | requested | approved | rejected | confirmedByShipper | shipmentCompleted | rejectedByShipper | demoCompleted |
|------|-----------|----------|----------|--------------------|-------------------|-------------------|---------------|
| **Admin** | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… |
| **Moderator** | âœ… | âœ… (ë³¸ì¸ ì‹œì—° ì œì™¸) | âœ… (ë³¸ì¸ ì‹œì—° ì œì™¸) | âŒ | âŒ | âŒ | âŒ |
| **User** | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ |
| **Supplier** | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ |

## 3. ê¶Œí•œ ì‹œìŠ¤í…œ ì ìš©

### 3.1 ê¶Œí•œë³„ ì ‘ê·¼ ì œì–´

#### Admin (ê´€ë¦¬ì)

- âœ… ëª¨ë“  ì‹œì—° ì¡°íšŒ/ìƒì„±/ìˆ˜ì •
- âœ… ëª¨ë“  ìƒíƒœ ë³€ê²½ ê¶Œí•œ
- âœ… ì‹œì—° ì‚­ì œ ê¶Œí•œ
- âœ… ì‹œì—° ê´€ë ¨ ì¬ê³  ê´€ë¦¬

#### Moderator (1ì°¨ìŠ¹ì¸ê¶Œì)

- âœ… ì‹œì—° ì¡°íšŒ (ì½ê¸° ì „ìš©)
- âœ… ì´ˆê¸° ìŠ¹ì¸ ë‹¨ê³„ ê´€ë¦¬ (`requested` â†’ `approved`/`rejected`)
- âŒ ì‹œì—° ì§„í–‰ ë‹¨ê³„ ê´€ë¦¬ ë¶ˆê°€
- âŒ ì§ì ‘ì ì¸ ì¬ê³  ìˆ˜ì • ë¶ˆê°€

#### User (ì¼ë°˜ ì‚¬ìš©ì)

- âœ… ìì‹ ì´ ìš”ì²­í•œ ì‹œì—° ì¡°íšŒ
- âœ… ì‹œì—° ìš”ì²­ ìƒì„±
- âŒ ìƒíƒœ ë³€ê²½ ë¶ˆê°€
- âŒ íƒ€ì¸ì˜ ì‹œì—° ì¡°íšŒ ë¶ˆê°€

#### Supplier (ì™¸ë¶€ì—…ì²´)

- âœ… ìì‹ ê³¼ ê´€ë ¨ëœ ì‹œì—° ì¡°íšŒ
- âŒ ì‹œì—° ìƒì„± ë¶ˆê°€
- âŒ ìƒíƒœ ë³€ê²½ ë¶ˆê°€

### 3.2 ë°ì´í„° ì ‘ê·¼ ì œì–´

```typescript
// íŒ€ ê¸°ë°˜ ë°ì´í„° ê²©ë¦¬
const { data: demosResponse } = useDemosByTeam(selectedTeamId);

// ì‚¬ìš©ì ê¶Œí•œ í™•ì¸
const canManageDemo =
  user.accessLevel === "admin" || user.accessLevel === "moderator";
const canApproveDemo =
  user.accessLevel === "admin" || user.accessLevel === "moderator";
const canManageShipment = user.accessLevel === "admin";
```

## 4. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„

### 4.1 ì‹œì—° ì¡°íšŒ ë¡œì§

#### íŒ€ë³„ ì‹œì—° ëª©ë¡ ì¡°íšŒ

```typescript
// src/hooks/(useDemo)/useDemoQueries.ts
export const useDemosByTeam = (teamId: number) => {
  return useQuery({
    queryKey: ["demos", "team", teamId],
    queryFn: () => getDemoByTeamId(teamId),
    enabled: !!teamId,
    staleTime: 30 * 60 * 1000, // 30ë¶„ ìºì‹±
  });
};
```

**íŠ¹ì§•:**

- íŒ€ ID ê¸°ë°˜ ë°ì´í„° ê²©ë¦¬
- 30ë¶„ ìºì‹±ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”
- ìë™ refetch ë°©ì§€ë¡œ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ìµœì†Œí™”

#### ë‹¨ì¼ ì‹œì—° ì¡°íšŒ

```typescript
export const useSingleDemo = (demoId: number) => {
  return useQuery({
    queryKey: ["demo", demoId],
    queryFn: () => getDemoById(demoId),
    enabled: !!demoId,
    staleTime: 30 * 60 * 1000,
  });
};
```

### 4.2 ì‹œì—° ìƒì„± ë¡œì§

```typescript
// src/hooks/(useDemo)/useDemoMutations.ts
export const useCreateDemo = () => {
  const queryClient = useQueryClient();

  return useMutation<ApiResponse, Error, void>({
    mutationFn: () => createDemo(),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ["demos"] });
    },
  });
};
```

**ìƒì„± í”„ë¡œì„¸ìŠ¤:**

1. ì‹œì—° ìƒì„± ìš”ì²­ (`createDemo()`)
2. ì´ˆê¸° ìƒíƒœ `requested`ë¡œ ì„¤ì •
3. ê´€ë ¨ ìºì‹œ ë¬´íš¨í™” (`["demos"]`)
4. ìë™ ëª©ë¡ ìƒˆë¡œê³ ì¹¨

### 4.3 ì‹œì—° ìƒíƒœ ë³€ê²½ ë¡œì§

```typescript
export const useUpdateDemoStatus = () => {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: ({ id, data }: { id: number; data: UpdateDemoStatusDto }) =>
      updateDemoStatusById(id, { status: data.status }),
    onSuccess: async (response, variables) => {
      if (response.success) {
        // ê¸°ë³¸ ìºì‹œ ë¬´íš¨í™”
        await queryClient.invalidateQueries({ queryKey: ["demos"] });
        await queryClient.invalidateQueries({
          queryKey: ["demo", variables.id],
        });

        // ì‹œì—° ì¶œê³  ì™„ë£Œ ì‹œ ì¬ê³  ì—°ë™
        if (variables.data.status === DemoStatus.shipmentCompleted) {
          await queryClient.invalidateQueries({ queryKey: ["inventory"] });
          await queryClient.invalidateQueries({ queryKey: ["shipments"] });
          await queryClient.invalidateQueries({ queryKey: ["warehouseItems"] });
        }
      }
    },
  });
};
```

**ìƒíƒœ ë³€ê²½ í”„ë¡œì„¸ìŠ¤:**

1. ê¶Œí•œ ê²€ì¦ (í´ë¼ì´ì–¸íŠ¸ + ì„œë²„)
2. ìƒíƒœ ë³€ê²½ ìš”ì²­
3. ì„±ê³µ ì‹œ ê´€ë ¨ ìºì‹œ ë¬´íš¨í™”
4. íŠ¹ì • ìƒíƒœ ì‹œ ì¶”ê°€ ë°ì´í„° ê°±ì‹ 

## 5. ì¬ê³  ì—°ë™ ë¡œì§

### 5.1 ì‹œì—° ì¶œê³  ì‹œ ì¬ê³  ì²˜ë¦¬

```typescript
// ì‹œì—° ì¶œê³  ì™„ë£Œ ìƒíƒœ ë³€ê²½ ì‹œ
if (variables.data.status === DemoStatus.demoShipmentCompleted) {
  // 1. ì¬ê³  ì •ë³´ ìµœì‹ í™”
  await queryClient.invalidateQueries({ queryKey: ["inventory"] });

  // 2. ì…/ì¶œê³  ì •ë³´ ìµœì‹ í™”
  await queryClient.invalidateQueries({ queryKey: ["shipments"] });

  // 3. ì°½ê³  ì•„ì´í…œ ì •ë³´ ìµœì‹ í™”
  await queryClient.invalidateQueries({ queryKey: ["warehouseItems"] });
}
```

### 5.2 ì¬ê³  ì—°ë™ ê·œì¹™

| ì‹œì—° ìƒíƒœ           | ì¬ê³  ì˜í–¥      | ì²˜ë¦¬ ë°©ì‹ |
| ------------------- | -------------- | --------- |
| `shipmentCompleted` | ì¬ê³  ì°¨ê°      | ìë™ ì²˜ë¦¬ |
| `demoCompleted`     | ì¬ê³  ë³µêµ¬      | ìë™ ì²˜ë¦¬ |
| ê¸°íƒ€ ìƒíƒœ           | ì¬ê³  ì˜í–¥ ì—†ìŒ | -         |

## 6. ìºì‹± ì „ëµ

### 6.1 ìºì‹œ í‚¤ êµ¬ì¡°

```typescript
// ìºì‹œ í‚¤ ëª…ëª… ê·œì¹™
["demos", "team", teamId][("demo", demoId)]["demos"]; // íŒ€ë³„ ì‹œì—° ëª©ë¡ // ë‹¨ì¼ ì‹œì—° // ëª¨ë“  ì‹œì—° (ë¬´íš¨í™”ìš©)
```

### 6.2 ìºì‹œ ë¬´íš¨í™” ì „ëµ

```typescript
// ì‹œì—° ìƒì„± ì‹œ
queryClient.invalidateQueries({ queryKey: ["demos"] });

// ì‹œì—° ìƒíƒœ ë³€ê²½ ì‹œ
queryClient.invalidateQueries({ queryKey: ["demos"] });
queryClient.invalidateQueries({ queryKey: ["demo", demoId] });

// ì¬ê³  ì—°ë™ ì‹œ (ì‹œì—° ì¶œê³  ì™„ë£Œ)
queryClient.invalidateQueries({ queryKey: ["inventory"] });
queryClient.invalidateQueries({ queryKey: ["shipments"] });
queryClient.invalidateQueries({ queryKey: ["warehouseItems"] });
```

### 6.3 ìºì‹œ ì„¤ì •

- **staleTime**: 30ë¶„ (30 _ 60 _ 1000ms)
- **gcTime**: 30ë¶„ (30 _ 60 _ 1000ms)
- **refetchOnWindowFocus**: false
- **refetchOnMount**: false
- **refetchOnReconnect**: false

## 7. ì—ëŸ¬ ì²˜ë¦¬

### 7.1 API ì—ëŸ¬ ì²˜ë¦¬

```typescript
// demo-api.ts ì˜ˆì‹œ
export const getDemoByTeamId = async (teamId: number) => {
  try {
    const response = await api.get(`/order/demo/team/${teamId}`);
    return response.data;
  } catch {
    return {
      success: false,
      message: "ì£¼ë¬¸ ì‹œì—° ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",
    };
  }
};
```

### 7.2 Hook ë ˆë²¨ ì—ëŸ¬ ì²˜ë¦¬

```typescript
// ì‚¬ìš© ì˜ˆì‹œ
const { data, error, isLoading } = useDemosByTeam(teamId);

if (error) {
  console.error("ì‹œì—° ì¡°íšŒ ì‹¤íŒ¨:", error);
  // ì—ëŸ¬ UI í‘œì‹œ
}
```

## 8. ì‚¬ìš© ì˜ˆì‹œ

### 8.1 ê¸°ë³¸ ì‚¬ìš©ë²•

```typescript
import { useDemo } from "@/hooks/useDemo";
import { authStore } from "@/store/authStore";
import { DemoStatus } from "@/types/demo/demo";

const DemoComponent = () => {
  const { useDemosByTeam, useCreateDemo, useUpdateDemoStatus } = useDemo();
  const selectedTeamId = authStore((state) => state.selectedTeam?.id);

  // ì‹œì—° ëª©ë¡ ì¡°íšŒ
  const {
    data: demosResponse,
    isLoading,
    error,
  } = useDemosByTeam(selectedTeamId || 0);

  // ì‹œì—° ìƒì„±
  const createDemoMutation = useCreateDemo();

  // ì‹œì—° ìƒíƒœ ë³€ê²½
  const updateStatusMutation = useUpdateDemoStatus();

  const handleCreateDemo = async () => {
    try {
      await createDemoMutation.mutateAsync();
      toast.success("ì‹œì—°ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
    } catch (error) {
      toast.error("ì‹œì—° ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
    }
  };

  const handleUpdateStatus = async (demoId: number, status: DemoStatus) => {
    try {
      await updateStatusMutation.mutateAsync({ id: demoId, data: { status } });
      toast.success("ì‹œì—° ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
    } catch (error) {
      toast.error("ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
    }
  };

  return <div>{/* ì‹œì—° ëª©ë¡ ë Œë”ë§ */}</div>;
};
```

### 8.2 ê¶Œí•œ ê¸°ë°˜ UI ì œì–´

```typescript
import { useCurrentUser } from "@/hooks/useCurrentUser";

const DemoManagement = () => {
  const { user } = useCurrentUser();
  const canManageDemo =
    user?.accessLevel === "admin" || user?.accessLevel === "moderator";
  const canManageShipment = user?.accessLevel === "admin";

  return (
    <div>
      {canManageDemo && <button onClick={handleCreateDemo}>ì‹œì—° ìƒì„±</button>}

      {canManageShipment && (
        <button
          onClick={() =>
            handleUpdateStatus(demoId, DemoStatus.shipmentCompleted)
          }
        >
          ì‹œì—° ì¶œê³  ì™„ë£Œ
        </button>
      )}
    </div>
  );
};
```

## 9. ì„±ëŠ¥ ìµœì í™”

### 9.1 React Query ìµœì í™”

- **ì„ íƒì  fetching**: `enabled` ì˜µì…˜ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ìš”ì²­ ë°©ì§€
- **ìºì‹œ ìµœì í™”**: 30ë¶„ ìºì‹±ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ìµœì†Œí™”
- **ë°±ê·¸ë¼ìš´ë“œ ì—…ë°ì´íŠ¸ ë°©ì§€**: refetch ì˜µì…˜ë“¤ì„ falseë¡œ ì„¤ì •

### 9.2 ë©”ëª¨ë¦¬ ê´€ë¦¬

- **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: gcTime ì„¤ì •ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ìºì‹œ ìë™ ì •ë¦¬
- **ìºì‹œ ë¬´íš¨í™”**: ì •í™•í•œ queryKeyë¡œ í•„ìš”í•œ ìºì‹œë§Œ ë¬´íš¨í™”

## 10. ì‹œì—° ì‹ ì²­ ì‹œìŠ¤í…œ

### 10.1 ì‹œì—° ì‹ ì²­ í¼ êµ¬ì¡°

#### ê¸°ë³¸ ì •ë³´ í•„ë“œ

```typescript
// src/components/demonstration/DemonstrationRequestForm.tsx
interface OrderRequestFormData {
  manager: string; // ë‹´ë‹¹ì
  requester: string; // ìš”ì²­ì (ìë™ ì„¤ì •)
  receiver: string; // ìˆ˜ë ¹ì
  receiverPhone: string; // ìˆ˜ë ¹ì ì—°ë½ì²˜
  address: string; // ë°°ì†¡ ì£¼ì†Œ
  detailAddress: string; // ìƒì„¸ ì£¼ì†Œ
  requestDate: string; // ìš”ì²­ì¼
  setupDate: string; // ì„¤ì¹˜ì¼
  notes: string; // ë¹„ê³ 
  supplierId: number | null; // ê³µê¸‰ì—…ì²´ ID
  warehouseId: number | null; // ì°½ê³  ID
}
```

#### ì‹œì—° ì „ìš© í•„ë“œ (Demo ì¸í„°í˜ì´ìŠ¤)

```typescript
// src/types/demo/demo.ts
interface Demo {
  requester: string; // ìš”ì²­ì
  handler: string; // í–‰ì‚¬ ë‹´ë‹¹ì
  demoManager: string; // ì‹œì—° ë‹´ë‹¹ì
  demoManagerPhone: string; // ì‹œì—° ë‹´ë‹¹ì ì—°ë½ì²˜
  memo: string; // ë©”ëª¨

  // UI ì¶”ê°€ í•„ë“œë“¤
  demoTitle: string; // ì‹œì—° ì œëª©
  demoNationType: string; // êµ­ë‚´í–‰ì‚¬/í•´ì™¸í–‰ì‚¬ êµ¬ë¶„
  demoAddress: string; // ì‹œì—° ì£¼ì†Œ
  demoPaymentType: string; // ìœ ë£Œ/ë¬´ë£Œ
  demoPrice?: number; // ì‹œì—° ê°€ê²©
  demoPaymentDate?: Date; // ê²°ì œ ì˜ˆì •ì¼
  demoCurrencyUnit: string; // í™”í ë‹¨ìœ„

  // ì‹œì—° ì¼ì •
  demoStartDate: string; // ìƒì°¨ ë‚ ì§œ
  demoStartTime: string; // ìƒì°¨ ì‹œê°„
  demoStartDeliveryMethod: string; // ìƒì°¨ ë°©ë²•
  demoEndDate: string; // í•˜ì°¨ ë‚ ì§œ
  demoEndTime: string; // í•˜ì°¨ ì‹œê°„
  demoEndDeliveryMethod: string; // í•˜ì°¨ ë°©ë²•

  // ì‹œìŠ¤í…œ í•„ë“œ
  userId: number; // ìš”ì²­ì ID
  warehouseId: number; // ì‹œì—°í’ˆ ì°½ê³ 
  demoItems: Item[]; // ì‹œì—° ì•„ì´í…œ ëª©ë¡
  user: IUser; // ìš”ì²­ì ì •ë³´
  files: File[]; // ì²¨ë¶€ íŒŒì¼ë“¤
}
```

### 10.2 ì‹œì—° ì‹ ì²­ í”„ë¡œì„¸ìŠ¤

#### 1. ê¸°ë³¸ ì •ë³´ ì…ë ¥

- **ìš”ì²­ì**: ìë™ìœ¼ë¡œ í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ ì„¤ì •
- **ìˆ˜ë ¹ì**: ì‹œì—° ë‹´ë‹¹ì ì •ë³´ ì…ë ¥
- **ì°½ê³  ì„ íƒ**: ê¶Œí•œì´ ìˆëŠ” ì°½ê³ ë§Œ ì„ íƒ ê°€ëŠ¥
- **ì£¼ì†Œ ì…ë ¥**: ì£¼ì†Œ ê²€ìƒ‰ APIë¥¼ í†µí•œ ì •í™•í•œ ì£¼ì†Œ ì…ë ¥

#### 2. ì‹œì—°í’ˆ ì„ íƒ

```typescript
// ì°½ê³ ë³„ ì‹¤ì œ ì¬ê³  ì•„ì´í…œ ëª©ë¡ ê¸°ë°˜ ë™ì  ì„ íƒ
const currentWarehouseItems = useMemo(() => {
  if (propWarehouseItems && warehouseId) {
    return propWarehouseItems[warehouseId] || [];
  }
  return (warehouseItemsData?.data as Item[]) || [];
}, [propWarehouseItems, warehouseId, warehouseItemsData]);
```

#### 3. ê¶Œí•œ ê²€ì¦

```typescript
// ì°½ê³  ì ‘ê·¼ ê¶Œí•œ í™•ì¸
if (user && !hasWarehouseAccess(user, warehouseId)) {
  const warehouseName =
    effectiveWarehousesList.find((w) => w.id === warehouseId)?.warehouseName ||
    "ì„ íƒëœ ì°½ê³ ";
  toast.error(getWarehouseAccessDeniedMessage(warehouseName));
  return;
}
```

#### 4. í¼ ê²€ì¦

```typescript
const validateForm = (): boolean => {
  if (!formData.requester.trim()) {
    toast.error("ìš”ì²­ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");
    return false;
  }
  if (!formData.receiver.trim()) {
    toast.error("ìˆ˜ë ¹ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return false;
  }
  // ... ê¸°íƒ€ í•„ìˆ˜ í•„ë“œ ê²€ì¦
  if (orderItems.length === 0) {
    toast.error("ì‹œì—°í’ˆì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
    return false;
  }
  return true;
};
```

### 10.3 ì‹œì—° ìƒíƒœ ê´€ë¦¬

#### ìƒíƒœ ì—´ê±°í˜•

```typescript
// src/types/demo/demo.ts
export enum DemoStatus {
  requested = "requested", // ìš”ì²­
  approved = "approved", // ìŠ¹ì¸
  rejected = "rejected", // ë°˜ë ¤
  confirmedByShipper = "confirmedByShipper", // ì¶œê³ ì í™•ì¸
  shipmentCompleted = "shipmentCompleted", // ì¶œê³  ì™„ë£Œ
  rejectedByShipper = "rejectedByShipper", // ì¶œê³ ì ë°˜ë ¤
  demoCompleted = "demoCompleted", //X ì‹œì—° ì¢…ë£Œ
}
```

#### ìƒíƒœë³„ ê¶Œí•œ

- **User**: ì‹œì—° ìš”ì²­ ìƒì„± (`requested` ìƒíƒœë¡œ ì‹œì‘)
- **Moderator**: ì´ˆê¸° ìŠ¹ì¸/ë°˜ë ¤ (`requested` â†’ `approved`/`rejected`)
- **Admin**: ì „ì²´ ìƒíƒœ ê´€ë¦¬ ë° ì‹œì—° ì§„í–‰ ë‹¨ê³„ ê´€ë¦¬

### 10.4 íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥

#### íŒŒì¼ ê´€ë¦¬

```typescript
// íŒŒì¼ ì„ íƒ ë° ê´€ë¦¬
const [files, setFiles] = useState<File[]>([]);

const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
  const selectedFiles = e.target.files;
  if (selectedFiles) {
    const newFiles = Array.from(selectedFiles);
    setFiles((prev) => [...prev, ...newFiles]);
  }
};

const handleRemoveFile = (index: number) => {
  setFiles((prev) => prev.filter((_, i) => i !== index));
};
```

### 10.5 ì‹œì—° ì‹ ì²­ ì™„ë£Œ í›„ ì²˜ë¦¬

#### í¼ ì´ˆê¸°í™”

```typescript
// ì‹œì—° ì‹ ì²­ ì™„ë£Œ í›„ í¼ ì´ˆê¸°í™”
setFormData({
  manager: "",
  requester: user?.name || auth?.name || "",
  receiver: "",
  receiverPhone: "",
  address: "",
  detailAddress: "",
  requestDate: "",
  setupDate: "",
  notes: "",
  supplierId: null,
  warehouseId: null,
});
setOrderItems([]);
setFiles([]);
```

#### ì„±ê³µ ë©”ì‹œì§€

```typescript
toast.success("ì‹œì—° ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
router.push("/"); // ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™
```

### 10.6 ì‹œì—° ì•„ì´í…œ ì„ íƒ ë¡œì§

#### ì•„ì´í…œ ID ë§¤í•‘ ê·œì¹™

```typescript
// DemoItemSelector.tsx - ì•„ì´í…œ ì„ íƒ ì‹œ
const newItem: SelectedDemoItem = {
  itemName: warehouseItem.itemName,
  quantity: 1,
  teamItem: warehouseItem.teamItem,
  itemId: warehouseItem.id, // ì°½ê³  ì•„ì´í…œì˜ ê³ ìœ  ID (ì¬ê³  ì—°ë™ìš©)
  memo: warehouseItem.teamItem.memo,
};
```

**ì¤‘ìš”**: `itemId`ëŠ” `warehouseItem.id`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì°½ê³ ì˜ íŠ¹ì • ì•„ì´í…œ ì¬ê³ ì— ì§ì ‘ ì˜í–¥ì„ ì£¼ë„ë¡ êµ¬í˜„ë¨. `warehouseItem.teamItem.id`ê°€ ì•„ë‹Œ `warehouseItem.id`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ì¬ê³  ê´€ë¦¬ì˜ ì •í™•ì„±ì„ ìœ„í•¨.

## 11. í–¥í›„ í™•ì¥ ê°€ëŠ¥ì„±

### 11.1 ëŒ“ê¸€ ì‹œìŠ¤í…œ

```typescript
// í–¥í›„ ì¶”ê°€ ê°€ëŠ¥í•œ ëŒ“ê¸€ ê¸°ëŠ¥
export const useDemoComments = (demoId: number) => {
  // order commentsì™€ ìœ ì‚¬í•œ êµ¬ì¡°ë¡œ êµ¬í˜„ ê°€ëŠ¥
};
```

### 11.2 íŒŒì¼ ì—…ë¡œë“œ

```typescript
// ì‹œì—° ê´€ë ¨ íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥
export const useDemoFileUpload = () => {
  // order file uploadì™€ ìœ ì‚¬í•œ êµ¬ì¡°ë¡œ êµ¬í˜„ ê°€ëŠ¥
};
```

### 11.3 ì•Œë¦¼ ì‹œìŠ¤í…œ

```typescript
// ì‹œì—° ìƒíƒœ ë³€ê²½ ì‹œ ì•Œë¦¼ ê¸°ëŠ¥
export const useDemoNotifications = () => {
  // ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ ì—°ë™ ê°€ëŠ¥
};
```

---

**ğŸ“ ì£¼ì˜ì‚¬í•­:**

- ëª¨ë“  ì‹œì—° ê´€ë ¨ ì‘ì—…ì€ íŒ€ ë‹¨ìœ„ë¡œ ê²©ë¦¬ë˜ì–´ ì²˜ë¦¬ë©ë‹ˆë‹¤
- ê¶Œí•œ ì‹œìŠ¤í…œì„ ë°˜ë“œì‹œ ì¤€ìˆ˜í•˜ì—¬ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤
- ì¬ê³  ì—°ë™ ì‹œ ë°ì´í„° ì •í•©ì„±ì„ ë³´ì¥í•´ì•¼ í•©ë‹ˆë‹¤
- ìºì‹œ ë¬´íš¨í™”ëŠ” ì •í™•í•œ queryKeyë¡œ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤
